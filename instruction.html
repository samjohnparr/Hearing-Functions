<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hearing Functions: Instructional Examples</title>
<style>
  :root{
    --page-w: 1000px;
    --fig-w: 820;   /* logical SVG width (viewBox) */
    --fig-h: 480;   /* logical SVG height (viewBox) */
  }
  body{
    font-family: system-ui, Segoe UI, Helvetica, Arial, sans-serif;
    max-width: var(--page-w);
    margin: 24px auto;
    padding: 0 16px;
    line-height: 1.55;
  }
  h1{ font-size:1.8rem; margin:.2rem 0 .4rem }
  h2{ font-size:1.25rem; margin:1.6rem 0 .6rem }
  .author{ margin:.1rem 0 1rem; color:#444; font-size:1rem; }
  .author a{ color:inherit; text-decoration:none; border-bottom:1px dashed #888; }
  .author a:hover{ text-decoration:underline; }
  .note{ color:#333; font-size:1rem; margin-bottom:14px }
  .stack{ display:block }
  .card{
    border:1px solid #ddd; border-radius:14px; background:#fafafa;
    padding:14px; margin:14px 0;
  }
  .head{
    display:flex; justify-content:space-between; align-items:center; gap:12px;
    margin-bottom:8px; flex-wrap:wrap;
  }
  .tag{
    font-size:.8rem; background:#e8eefc; border:1px solid #b9cdf9;
    padding:2px 10px; border-radius:999px; white-space:nowrap;
  }
  .fig{
    background:#fff; border:1px solid #ddd; border-radius:10px;
    padding:8px; margin:8px 0 10px 0;
  }
  svg{ width:100%; height:auto; display:block; }
  .caption{ color:#666; text-align:center; font-size:.95rem; margin-top:6px }
  audio{ width:100%; margin:8px 0 }
  .mini{ font-size:1rem; color:#333; margin:.35rem 0 }
  .em{ font-weight:600 }

  /* Home button */
  .homebar{display:flex;justify-content:flex-start;align-items:center;margin:8px 0 12px}
  .homebtn{
    display:inline-block;padding:.5rem .9rem;border:1px solid #bbb;border-radius:10px;
    background:#f5f5f5;text-decoration:none;color:#111;font-weight:600;
  }
  .homebtn:hover{background:#eee;}
</style>

<div class="homebar">
  <a class="homebtn" href="index.html">üè† Home</a>
</div>

<h1>Hearing Functions: Instructional Examples</h1>
<p class="author">by <a href="https://samjohnparr.github.io/" target="_blank" rel="noopener">Samuel John E. Parre√±o</a></p>

<p class="note">
  We‚Äôre turning graphs into sound. Each short ‚Äúbeep‚Äù walks from the <em>left</em> of the graph to the <em>right</em>.
  <br><br>
  Two ways we make sound:
  <br>‚Ä¢ <span class="em">Value ‚Üí Pitch (V2P)</span>: Higher graph = higher note. Lower graph = lower note.
  <br>‚Ä¢ <span class="em">Slope ‚Üí Pitch (S2P)</span>: Steeper = higher note. Flatter = lower note. (You‚Äôre ‚Äúhearing‚Äù how fast the graph is changing.)
  <br><br>
  All clips use the same instrument, speed, and pitch range.
</p>

<h2>Value ‚Üí Pitch (V2P): Hear the height of the graph</h2>
<div id="v2p" class="stack"></div>

<h2>Slope ‚Üí Pitch (S2P): Hear how fast the graph is changing</h2>
<div id="s2p" class="stack"></div>

<script>
/* ---------- plotting helpers ---------- */
function sampleY(fn, domain, N=400){
  const [x0,x1]=domain, xs=[...Array(N)].map((_,i)=>x0+(x1-x0)*i/(N-1));
  const ys=xs.map(fn);
  let ymin=Math.min(...ys), ymax=Math.max(...ys);
  if(!isFinite(ymin)||!isFinite(ymax)){ymin=-1;ymax=1;}
  if(ymax-ymin<1e-6){ymax=ymin+1;}
  const pad=0.12*(ymax-ymin);
  return {xs, ys, ymin:ymin-pad, ymax:ymax+pad, x0, x1};
}
const mapX=(x,a,b,W)=> (x-a)/(b-a)*W;
const mapY=(y,a,b,H)=> H-(y-a)/(b-a)*H;

function drawGraph(container, fn, domain, caption){
  const NS="http://www.w3.org/2000/svg";
  const W=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--fig-w'))||820;
  const H=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--fig-h'))||480;

  const svg=document.createElementNS(NS,"svg");
  svg.setAttribute("viewBox",`0 0 ${W} ${H}`);

  const {xs,ys,ymin,ymax,x0,x1}=sampleY(fn, domain, 400);

  if(x0<=0 && x1>=0){
    const xz=mapX(0,x0,x1,W);
    const v=document.createElementNS(NS,"line");
    v.setAttribute("x1",xz); v.setAttribute("x2",xz); v.setAttribute("y1",0); v.setAttribute("y2",H);
    v.setAttribute("stroke","#bbb"); v.setAttribute("stroke-width","1.2"); svg.appendChild(v);
  }
  if(ymin<=0 && ymax>=0){
    const yz=mapY(0,ymin,ymax,H);
    const h=document.createElementNS(NS,"line");
    h.setAttribute("x1",0); h.setAttribute("x2",W); h.setAttribute("y1",yz); h.setAttribute("y2",yz);
    h.setAttribute("stroke","#bbb"); h.setAttribute("stroke-width","1.2"); svg.appendChild(h);
  }

  let d=""; for(let i=0;i<xs.length;i++){
    const X=mapX(xs[i],x0,x1,W), Y=mapY(ys[i],ymin,ymax,H); d+=(i?` L ${X} ${Y}`:`M ${X} ${Y}`);
  }
  const path=document.createElementNS(NS,"path");
  path.setAttribute("d",d); path.setAttribute("fill","none"); path.setAttribute("stroke","#222"); path.setAttribute("stroke-width","2.5");
  svg.appendChild(path);

  const wrap=document.createElement("div"); wrap.className="fig";
  const cap=document.createElement("div"); cap.className="caption"; cap.textContent=caption||"";
  wrap.appendChild(svg); wrap.appendChild(cap);
  container.appendChild(wrap);
}

/* ---------- examples (match your PRAC_*.wav filenames) ---------- */
const V2P = [
  {
    id:"PRAC_V2P_linear_pos_very_gentle", label:"Line going up (gentle)",
    fn:(x)=>0.10*x, domain:[-5,5], src:"audio/PRAC_V2P_linear_pos_very_gentle.wav",
    listen:"The note slowly goes up.",
    discuss:"The graph climbs a little each step, so the pitch also climbs a little each step."
  },
  {
    id:"PRAC_V2P_linear_neg_very_steep", label:"Line going down (very steep)",
    fn:(x)=>-1.30*x, domain:[-5,5], src:"audio/PRAC_V2P_linear_neg_very_steep.wav",
    listen:"The note drops fast and by a lot.",
    discuss:"The graph falls quickly, so the sound falls quickly too."
  },
  {
    id:"PRAC_V2P_exponential_slow", label:"Exponential up (starts slow, then faster)",
    fn:(x)=>Math.pow(2, x/3.0), domain:[-4,4], src:"audio/PRAC_V2P_exponential_slow.wav",
    listen:"Starts rising slowly, then rises faster near the end.",
    discuss:"The graph starts low and speeds up as it goes right, so the pitch does the same."
  },
  {
    id:"PRAC_V2P_exponential_decay", label:"Exponential down (fast drop, then levels)",
    fn:(x)=>Math.pow(2, -x/1.8), domain:[-4,4], src:"audio/PRAC_V2P_exponential_decay.wav",
    listen:"Drops quickly at first, then levels off.",
    discuss:"The graph falls a lot at the start and then flattens, so the pitch falls then steadies."
  },
];

const S2P = [
  {
    id:"PRAC_S2P_quadratic_shifted", label:"Parabola with lowest point at x=1",
    fn:(x)=>(x-1)**2, domain:[-1,3], src:"audio/PRAC_S2P_quadratic_shifted.wav",
    listen:"The note keeps going up from start to finish.",
    discuss:"We‚Äôre listening to how fast the graph changes. On the left it‚Äôs changing downward, then it changes more and more upward, so the pitch rises across the clip."
  },
  {
    id:"PRAC_S2P_log_wider", label:"Log shape going down",
    fn:(x)=>-Math.log(Math.max(1e-6,x)), domain:[0.5,5], src:"audio/PRAC_S2P_log_wider.wav",
    listen:"The note slowly goes down over time.",
    discuss:"At the start the graph changes more; later it changes less. Less change = lower pitch, so the sound gently falls."
  },
  {
    id:"PRAC_S2P_cubic_full", label:"Cubic S-curve (flattest in the middle)",
    fn:(x)=>-(x**3), domain:[-2,2], src:"audio/PRAC_S2P_cubic_full.wav",
    listen:"Low ‚Üí higher in the middle ‚Üí low again.",
    discuss:"The graph changes the least in the middle and the most near the ends. We hear that as the pitch peaking in the middle and dipping near both ends."
  },
  {
    id:"PRAC_S2P_logistic", label:"Logistic (fastest in the middle)",
    fn:(x)=>1/(1+Math.exp(-x)), domain:[-4,4], src:"audio/PRAC_S2P_logistic.wav",
    listen:"Low ‚Üí high ‚Üí low (highest in the middle).",
    discuss:"This graph changes slow ‚Üí fast ‚Üí slow. Fast change = higher pitch, so you hear the peak in the middle."
  },
];

/* ---------- render ---------- */
function makeCard(entry, mapping, mount){
  const card=document.createElement("div"); card.className="card";
  const head=document.createElement("div"); head.className="head";
  head.innerHTML = `<div><strong>${entry.label}</strong></div><div class="tag">${mapping}</div>`;
  const fig=document.createElement("div");
  drawGraph(fig, entry.fn, entry.domain, `y = f(x) on [${entry.domain[0]}, ${entry.domain[1]}]`);
  const player=document.createElement("audio"); player.controls=true; player.src=entry.src;
  const listen=document.createElement("div"); listen.className="mini"; listen.innerHTML = `<span class="em">What you'll hear:</span> ${entry.listen}`;
  const discuss=document.createElement("div"); discuss.className="mini"; discuss.innerHTML = `<span class="em">Why it sounds like that:</span> ${entry.discuss}`;
  card.appendChild(head); card.appendChild(fig); card.appendChild(player); card.appendChild(listen); card.appendChild(discuss);
  mount.appendChild(card);
}

const v2p = document.getElementById("v2p");
const s2p = document.getElementById("s2p");
V2P.forEach(e=>makeCard(e,"V2P (value ‚Üí pitch)", v2p));
S2P.forEach(e=>makeCard(e,"S2P (slope ‚Üí pitch)", s2p));
</script>
