<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hearing Functions — Instructional Examples</title>
<style>
  :root{--w:180px; --h:130px}
  body{font-family:system-ui,Segoe UI,Helvetica,Arial,sans-serif;max-width:1100px;margin:24px auto;padding:0 14px;line-height:1.5}
  h1{font-size:1.6rem;margin:.2rem 0 .6rem}
  h2{font-size:1.2rem;margin:1.4rem 0 .6rem}
  .note{color:#555;font-size:.95rem;margin-bottom:10px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:14px}
  .card{border:1px solid #ddd;border-radius:12px;background:#fafafa;padding:12px}
  .head{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  .tag{font-size:.75rem;background:#e8eefc;border:1px solid #b9cdf9;padding:2px 8px;border-radius:999px}
  .fig{background:#fff;border:1px solid #ddd;border-radius:10px;padding:8px;margin-bottom:8px}
  svg{width:100%;height:auto;max-width:var(--w);max-height:var(--h);display:block;margin:0 auto}
  .caption{color:#666;text-align:center;font-size:.9rem;margin-top:4px}
  audio{width:100%; margin:6px 0}
  .mini{font-size:.92rem;color:#333;margin:.25rem 0}
  .em{font-weight:600}
</style>

<h1>Hearing Functions — Instructional Examples</h1>
<p class="note">
  All clips use the same timbre, tempo, and pitch range (sine, 40 steps, 0.20 s/step, 0.02 s gaps, 220–880 Hz).
  For <span class="em">value→pitch (V2P)</span>, a single fixed vertical scale is used across examples, so <span class="em">steeper lines sweep a wider pitch span</span>.
  For <span class="em">slope→pitch (S2P)</span>, you hear the <em>rate of change</em>: constant slope = constant tone; concave up = rising tone; concave down = falling tone.
</p>

<h2>Value → Pitch (V2P): Hear height / monotonicity</h2>
<div id="v2p" class="grid"></div>

<h2>Slope → Pitch (S2P): Hear rate / concavity</h2>
<div id="s2p" class="grid"></div>

<script>
// ---------- plotting helpers ----------
function sampleY(fn, domain, N=200){
  const [x0,x1]=domain, xs=[...Array(N)].map((_,i)=>x0+(x1-x0)*i/(N-1));
  const ys=xs.map(fn);
  let ymin=Math.min(...ys), ymax=Math.max(...ys);
  if(!isFinite(ymin)||!isFinite(ymax)){ymin=-1;ymax=1;}
  if(ymax-ymin<1e-6){ymax=ymin+1;}
  const pad=0.1*(ymax-ymin);
  return {xs, ys, ymin:ymin-pad, ymax:ymax+pad, x0, x1};
}
const mapX=(x,a,b,W)=> (x-a)/(b-a)*W;
const mapY=(y,a,b,H)=> H-(y-a)/(b-a)*H;
function drawGraph(container, fn, domain, caption){
  const NS="http://www.w3.org/2000/svg", W=180, H=130;
  const svg=document.createElementNS(NS,"svg"); svg.setAttribute("viewBox",`0 0 ${W} ${H}`);
  const {xs,ys,ymin,ymax,x0,x1}=sampleY(fn, domain, 200);
  // axes
  if(x0<=0 && x1>=0){
    const xz=mapX(0,x0,x1,W);
    const v=document.createElementNS(NS,"line");
    v.setAttribute("x1",xz); v.setAttribute("x2",xz); v.setAttribute("y1",0); v.setAttribute("y2",H);
    v.setAttribute("stroke","#bbb"); v.setAttribute("stroke-width","1"); svg.appendChild(v);
  }
  if(ymin<=0 && ymax>=0){
    const yz=mapY(0,ymin,ymax,H);
    const h=document.createElementNS(NS,"line");
    h.setAttribute("x1",0); h.setAttribute("x2",W); h.setAttribute("y1",yz); h.setAttribute("y2",yz);
    h.setAttribute("stroke","#bbb"); h.setAttribute("stroke-width","1"); svg.appendChild(h);
  }
  let d=""; for(let i=0;i<xs.length;i++){
    const X=mapX(xs[i],x0,x1,W), Y=mapY(ys[i],ymin,ymax,H); d+=(i?` L ${X} ${Y}`:`M ${X} ${Y}`);
  }
  const path=document.createElementNS(NS,"path");
  path.setAttribute("d",d); path.setAttribute("fill","none"); path.setAttribute("stroke","#222"); path.setAttribute("stroke-width","2"); svg.appendChild(path);

  const wrap=document.createElement("div"); wrap.className="fig";
  const cap=document.createElement("div"); cap.className="caption"; cap.textContent=caption||"";
  wrap.appendChild(svg); wrap.appendChild(cap);
  container.appendChild(wrap);
}

// ---------- examples (match WAV filenames you will generate) ----------
const V2P = [
  {
    id:"PRAC_V2P_linear_pos_very_gentle", label:"Linear ↑ (very gentle)",
    fn:(x)=>0.10*x, domain:[-5,5], src:"audio/PRAC_V2P_linear_pos_very_gentle.wav",
    listen:"A slow, steady rise across time (small pitch span).",
    discuss:"Constant positive slope but small magnitude ⇒ value increases slowly. With global scaling, gentle lines sweep a narrower pitch range than steep lines."
  },
  {
    id:"PRAC_V2P_linear_neg_very_steep", label:"Linear ↓ (very steep)",
    fn:(x)=>-1.30*x, domain:[-5,5], src:"audio/PRAC_V2P_linear_neg_very_steep.wav",
    listen:"A strong downward sweep (wide pitch span).",
    discuss:"Large negative slope: value drops quickly. Here the line reaches the top of the fixed scale on the left and the bottom on the right."
  },
  {
    id:"PRAC_V2P_exponential_slow", label:"Exponential ↑ (slow acceleration)",
    fn:(x)=>Math.pow(2, x/3.0), domain:[-4,4], src:"audio/PRAC_V2P_exponential_slow.wav",
    listen:"Rising contour; the rise feels slightly faster near the end.",
    discuss:"Values increase slowly at first then faster—concave up. In V2P we hear height; the end sounds higher because values grow faster there."
  },
  {
    id:"PRAC_V2P_exponential_decay", label:"Exponential decay ↓",
    fn:(x)=>Math.pow(2, -x/1.8), domain:[-4,4], src:"audio/PRAC_V2P_exponential_decay.wav",
    listen:"A quick drop that levels off.",
    discuss:"Values decrease rapidly then flatten—concave up but decreasing. In V2P this is a falling melody that slows its descent."
  },
];

const S2P = [
  {
    id:"PRAC_S2P_quadratic_shifted", label:"Quadratic (concave up), vertex at x=1",
    fn:(x)=>(x-1)**2, domain:[-1,3], src:"audio/PRAC_S2P_quadratic_shifted.wav",
    listen:"Tone rises throughout (lowest near the vertex).",
    discuss:"Slope is smallest at the vertex (x=1) and grows as x moves away ⇒ slope→pitch rises; concavity up means the rate is increasing."
  },
  {
    id:"PRAC_S2P_log_wider", label:"Log(x) (concave down)",
    fn:(x)=>Math.log(Math.max(1e-6,x)), domain:[0.5,5], src:"audio/PRAC_S2P_log_wider.wav",
    listen:"Tone falls steadily.",
    discuss:"Slope 1/x decreases as x increases ⇒ slope→pitch falls; concave down means rate is decreasing."
  },
  {
    id:"PRAC_S2P_cubic_full", label:"Cubic x³ (inflection at 0)",
    fn:(x)=>x**3, domain:[-2,2], src:"audio/PRAC_S2P_cubic_full.wav",
    listen:"U-shaped melody: high → low → high (minimum at x=0).",
    discuss:"Slope is 3x²: large at the ends, zero at x=0. Slope→pitch highlights the inflection—rate is lowest at the center, higher on both sides."
  },
  {
    id:"PRAC_S2P_logistic", label:"Logistic 1/(1+e^{-x}) (S-curve)",
    fn:(x)=>1/(1+Math.exp(-x)), domain:[-4,4], src:"audio/PRAC_S2P_logistic.wav",
    listen:"Bell-shaped melody: low → high → low (peak in the middle).",
    discuss:"The slope peaks at the inflection (x≈0) and is smaller at both ends. Slope→pitch makes the ‘fastest change’ moment audible."
  },
];

// ---------- render ----------
function makeCard(entry, mapping, mount){
  const card=document.createElement("div"); card.className="card";
  const head=document.createElement("div"); head.className="head";
  head.innerHTML = `<div><strong>${entry.label}</strong></div><div class="tag">${mapping}</div>`;
  const fig=document.createElement("div"); drawGraph(fig, entry.fn, entry.domain, `y = f(x) on [${entry.domain[0]}, ${entry.domain[1]}]`);
  const player=document.createElement("audio"); player.controls=true; player.src=entry.src;
  const listen=document.createElement("div"); listen.className="mini"; listen.innerHTML = `<span class="em">What to listen for:</span> ${entry.listen}`;
  const discuss=document.createElement("div"); discuss.className="mini"; discuss.innerHTML = `<span class="em">Math discussion:</span> ${entry.discuss}`;
  card.appendChild(head); card.appendChild(fig); card.appendChild(player); card.appendChild(listen); card.appendChild(discuss);
  mount.appendChild(card);
}
const v2p = document.getElementById("v2p");
const s2p = document.getElementById("s2p");
V2P.forEach(e=>makeCard(e,"V2P (value→pitch)", v2p));
S2P.forEach(e=>makeCard(e,"S2P (slope→pitch)", s2p));
</script>
