<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hearing Functions: Instructional Examples</title>
<style>
  :root{
    --page-w: 1000px;
    --fig-w: 820;   /* logical SVG width (viewBox) */
    --fig-h: 480;   /* logical SVG height (viewBox) */
  }
  body{
    font-family: system-ui, Segoe UI, Helvetica, Arial, sans-serif;
    max-width: var(--page-w);
    margin: 24px auto;
    padding: 0 16px;
    line-height: 1.55;
  }
  h1{ font-size:1.8rem; margin:.2rem 0 .4rem }
  h2{ font-size:1.25rem; margin:1.6rem 0 .6rem }
  .author{ margin:.1rem 0 1rem; color:#444; font-size:1rem; }
  .author a{ color:inherit; text-decoration:none; border-bottom:1px dashed #888; }
  .author a:hover{ text-decoration:underline; }
  .note{ color:#555; font-size:1rem; margin-bottom:14px }
  .stack{ display:block }          /* single column */
  .card{
    border:1px solid #ddd; border-radius:14px; background:#fafafa;
    padding:14px; margin:14px 0;
  }
  .head{
    display:flex; justify-content:space-between; align-items:center; gap:12px;
    margin-bottom:8px; flex-wrap:wrap;
  }
  .tag{
    font-size:.8rem; background:#e8eefc; border:1px solid #b9cdf9;
    padding:2px 10px; border-radius:999px; white-space:nowrap;
  }
  .fig{
    background:#fff; border:1px solid #ddd; border-radius:10px;
    padding:8px; margin:8px 0 10px 0;
  }
  svg{ width:100%; height:auto; display:block; }
  .caption{ color:#666; text-align:center; font-size:.95rem; margin-top:6px }
  audio{ width:100%; margin:8px 0 }
  .mini{ font-size:1rem; color:#333; margin:.35rem 0 }
  .em{ font-weight:600 }

  /* Home button */
  .homebar{display:flex;justify-content:flex-start;align-items:center;margin:8px 0 12px}
  .homebtn{
    display:inline-block;padding:.5rem .9rem;border:1px solid #bbb;border-radius:10px;
    background:#f5f5f5;text-decoration:none;color:#111;font-weight:600;
  }
  .homebtn:hover{background:#eee;}
</style>

<div class="homebar">
  <a class="homebtn" href="index.html">üè† Home</a>
</div>

<h1>Hearing Functions: Instructional Examples</h1>
<p class="author">by <a href="https://samjohnparr.github.io/" target="_blank" rel="noopener">Samuel John Parre√±o</a></p>

<p class="note">
  All clips use the same timbre, tempo, and pitch range (sine, 40 steps, 0.20 s/step, 0.02 s gaps, 220‚Äì880 Hz).
  Playback proceeds from the left end of the domain to the right end:
  the first tone corresponds to <em>x = x‚ÇÄ</em>, the last tone to <em>x = x‚ÇÅ</em>.
  For <span class="em">value‚Üípitch (V2P)</span>, pitch maps to the function‚Äôs value <em>f(x)</em>, so steeper lines sweep a wider pitch span under a fixed scale.
  For <span class="em">slope‚Üípitch (S2P)</span>, pitch maps to the signed slope <em>f‚Ä≤(x)</em>:
  constant slope = constant tone; concave up = rising tone (slope increases); concave down = falling tone (slope decreases).
</p>

<h2>Value ‚Üí Pitch (V2P): Hear height / monotonicity</h2>
<div id="v2p" class="stack"></div>

<h2>Slope ‚Üí Pitch (S2P): Hear rate / concavity</h2>
<div id="s2p" class="stack"></div>

<script>
/* ---------- plotting helpers ---------- */
function sampleY(fn, domain, N=400){
  const [x0,x1]=domain, xs=[...Array(N)].map((_,i)=>x0+(x1-x0)*i/(N-1));
  const ys=xs.map(fn);
  let ymin=Math.min(...ys), ymax=Math.max(...ys);
  if(!isFinite(ymin)||!isFinite(ymax)){ymin=-1;ymax=1;}
  if(ymax-ymin<1e-6){ymax=ymin+1;}
  const pad=0.12*(ymax-ymin);
  return {xs, ys, ymin:ymin-pad, ymax:ymax+pad, x0, x1};
}
const mapX=(x,a,b,W)=> (x-a)/(b-a)*W;
const mapY=(y,a,b,H)=> H-(y-a)/(b-a)*H;

function drawGraph(container, fn, domain, caption){
  const NS="http://www.w3.org/2000/svg";
  const W=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--fig-w'))||820;
  const H=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--fig-h'))||480;

  const svg=document.createElementNS(NS,"svg");
  svg.setAttribute("viewBox",`0 0 ${W} ${H}`);

  const {xs,ys,ymin,ymax,x0,x1}=sampleY(fn, domain, 400);

  if(x0<=0 && x1>=0){
    const xz=mapX(0,x0,x1,W);
    const v=document.createElementNS(NS,"line");
    v.setAttribute("x1",xz); v.setAttribute("x2",xz); v.setAttribute("y1",0); v.setAttribute("y2",H);
    v.setAttribute("stroke","#bbb"); v.setAttribute("stroke-width","1.2"); svg.appendChild(v);
  }
  if(ymin<=0 && ymax>=0){
    const yz=mapY(0,ymin,ymax,H);
    const h=document.createElementNS(NS,"line");
    h.setAttribute("x1",0); h.setAttribute("x2",W); h.setAttribute("y1",yz); h.setAttribute("y2",yz);
    h.setAttribute("stroke","#bbb"); h.setAttribute("stroke-width","1.2"); svg.appendChild(h);
  }

  let d=""; for(let i=0;i<xs.length;i++){
    const X=mapX(xs[i],x0,x1,W), Y=mapY(ys[i],ymin,ymax,H); d+=(i?` L ${X} ${Y}`:`M ${X} ${Y}`);
  }
  const path=document.createElementNS(NS,"path");
  path.setAttribute("d",d); path.setAttribute("fill","none"); path.setAttribute("stroke","#222"); path.setAttribute("stroke-width","2.5");
  svg.appendChild(path);

  const wrap=document.createElement("div"); wrap.className="fig";
  const cap=document.createElement("div"); cap.className="caption"; cap.textContent=caption||"";
  wrap.appendChild(svg); wrap.appendChild(cap);
  container.appendChild(wrap);
}

/* ---------- examples (match PRAC_*.wav filenames you generated) ---------- */
const V2P = [
  {
    id:"PRAC_V2P_linear_pos_very_gentle", label:"Linear ‚Üë (very gentle)",
    fn:(x)=>0.10*x, domain:[-5,5], src:"audio/PRAC_V2P_linear_pos_very_gentle.wav",
    listen:"A slow, steady rise across time (small pitch span).",
    discuss:"Constant positive slope but small magnitude ‚áí value increases slowly. With a fixed vertical scale, gentle lines sweep a narrower pitch range than steep lines."
  },
  {
    id:"PRAC_V2P_linear_neg_very_steep", label:"Linear ‚Üì (very steep)",
    fn:(x)=>-1.30*x, domain:[-5,5], src:"audio/PRAC_V2P_linear_neg_very_steep.wav",
    listen:"A strong downward sweep (wide pitch span).",
    discuss:"Large negative slope: value drops quickly. The fixed scale makes the rapid decrease clearly audible."
  },
  {
    id:"PRAC_V2P_exponential_slow", label:"Exponential ‚Üë (slow acceleration)",
    fn:(x)=>Math.pow(2, x/3.0), domain:[-4,4], src:"audio/PRAC_V2P_exponential_slow.wav",
    listen:"Rising contour; the rise feels slightly faster near the end.",
    discuss:"Values increase slowly at first then faster‚Äîconcave up. In V2P we hear height; the end sounds higher because values grow faster there."
  },
  {
    id:"PRAC_V2P_exponential_decay", label:"Exponential decay ‚Üì",
    fn:(x)=>Math.pow(2, -x/1.8), domain:[-4,4], src:"audio/PRAC_V2P_exponential_decay.wav",
    listen:"A quick drop that levels off.",
    discuss:"Values decrease rapidly then flatten‚Äîconcave up but decreasing. In V2P this is a falling melody that slows its descent."
  },
];

const S2P = [
  {
    id:"PRAC_S2P_quadratic_shifted", label:"Quadratic (concave up), vertex at x=1",
    fn:(x)=>(x-1)**2, domain:[-1,3], src:"audio/PRAC_S2P_quadratic_shifted.wav",
    listen:"Tone rises steadily from start to end; it crosses mid-pitch near the vertex.",
    discuss:"f‚Ä≤(x)=2(x‚àí1) increases from ‚àí2 to +4 across the domain. Slope‚Üípitch uses the signed slope, so pitch increases as the slope increases. At x=1 the slope is 0, so the pitch is around the middle of the clip‚Äôs range (not the minimum)."
  },
  {
    id:"PRAC_S2P_log_wider", label:"Log(x) (concave down)",
    fn:(x)=>-Math.log(Math.max(1e-6,x)), domain:[0.5,5], src:"audio/PRAC_S2P_log_wider.wav",
    listen:"Tone falls steadily (highest at the start, lowest at the end).",
    discuss:"Slope f‚Ä≤(x)=1/x is positive but decreases as x increases ‚áí slope‚Üípitch falls. Concave down means the rate of change is decreasing."
  },
  {
    id:"PRAC_S2P_cubic_full", label:"Cubic x¬≥ (inflection at 0)",
    fn:(x)=>-(x**3), domain:[-2,2], src:"audio/PRAC_S2P_cubic_full.wav",
    listen:"High ‚Üí low ‚Üí high (lowest at the center).",
    discuss:"Slope f‚Ä≤(x)=3x¬≤ is large at both ends and 0 at x=0. Slope‚Üípitch highlights the inflection‚Äîrate is lowest in the middle, higher on both sides."
  },
  {
    id:"PRAC_S2P_logistic", label:"Logistic 1/(1+e^{-x}) (S-curve)",
    fn:(x)=>1/(1+Math.exp(-x)), domain:[-4,4], src:"audio/PRAC_S2P_logistic.wav",
    listen:"Low ‚Üí high ‚Üí low (peak in the middle).",
    discuss:"The function increases everywhere, but its slope peaks near x‚âà0 and shrinks toward 0 near the ends. Because S2P maps the signed slope, the tone is low at both ends and highest near the midpoint."
  },
];

/* ---------- render ---------- */
function makeCard(entry, mapping, mount){
  const card=document.createElement("div"); card.className="card";
  const head=document.createElement("div"); head.className="head";
  head.innerHTML = `<div><strong>${entry.label}</strong></div><div class="tag">${mapping}</div>`;
  const fig=document.createElement("div");
  drawGraph(fig, entry.fn, entry.domain, `y = f(x) on [${entry.domain[0]}, ${entry.domain[1]}]`);
  const player=document.createElement("audio"); player.controls=true; player.src=entry.src;
  const listen=document.createElement("div"); listen.className="mini"; listen.innerHTML = `<span class="em">What to listen for:</span> ${entry.listen}`;
  const discuss=document.createElement("div"); discuss.className="mini"; discuss.innerHTML = `<span class="em">Math discussion:</span> ${entry.discuss}`;
  card.appendChild(head); card.appendChild(fig); card.appendChild(player); card.appendChild(listen); card.appendChild(discuss);
  mount.appendChild(card);
}

const v2p = document.getElementById("v2p");
const s2p = document.getElementById("s2p");
V2P.forEach(e=>makeCard(e,"V2P (value‚Üípitch)", v2p));
S2P.forEach(e=>makeCard(e,"S2P (slope‚Üípitch)", s2p));
</script>
